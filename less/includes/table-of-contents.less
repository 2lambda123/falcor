.toc-page {

  .table-of-contents {
    position: absolute;
    right: 0;
    top: 0;
    padding-left: @content-toc-gap;
    max-height: 90vh;

    & > .nav {
      position: fixed;
      will-change: transform;
      padding: 0 0;
      background-color: @toc-background;
      // alternate base background colors to try #26B2E7, #B987BB, #8BBE2D

      // Since the TOC is position: fixed, it must be manually sized
      @media (min-width: @screen-sm-min) and (max-width: @screen-sm-max) {
        width: 277px - @content-toc-gap;
      }
      @media (min-width: @screen-md-min) and (max-width: @screen-md-max) {
        width: 291px - @content-toc-gap;
      }
      @media (min-width: @screen-lg-min) {
        width: 292px - @content-toc-gap;
      }
    }

    @media (max-width: @screen-xs-max) {
      display: none;
    }
    @media (min-width: @screen-sm-min) and (max-width: @screen-sm-max) {
      width: @toc-width-sm;
    }
    @media (min-width: @screen-md-min) and (max-width: @screen-md-max) {
      width: @toc-width-md;
    }
    @media (min-width: @screen-lg-min) {
      width: @toc-width-lg;
    }

    // List styling overrides for ToC lists
    //
    // These selectors are messier than I'd like, because there's no
    // way to get full control of the html generated by kramdown's
    // TOC generator so one can add semantic classes to them
    list-style: none;
    ul, li {
      padding-left: 0;
      list-style: none;
    }

    // All level items / defaults
    .nav li > a, .nav li > span > a {
      color: @toc-link-color;
      display: block;
      padding-top: 1px;
      padding-bottom: 1px;
      &:hover {
        text-decoration: underline;
      }
    }


    // First level items only
    .nav > li {
      padding-top: 10px;
      & > a {
        padding: 5px @toc-indentation-per-level 5px 15px;
        font-size: 16px;

        &:hover {
          background: transparent;
        }
      }
      &.active > a {
        &, &:hover {
          background-color: @toc-active-background;
        }
      }
    }

    // Second level items only
    .nav > li > ul > li {
      & > a {
        padding-left: @toc-indentation-per-level * 2;
      }

      &.active > a {
        &, &:hover {
          background-color: @toc-active-background-sub-item;
        }
      }
    }

    // Third level items only
    .nav > li > ul > li > ul > li {
      & > a {
        padding-left: @toc-indentation-per-level * 3;
      }

      &.active > a {
        &, &:hover {
          background-color: @toc-active-background-sub-item-sub-item;
        }
      }
    }

    // .nav > li > ul > li.active > a {
    //   &, &:hover {
    //     background-color: @toc-active-background-sub-item;
    //   }
    // }
  }

  // Page sizing, to account for the space the ToC is taking up
  @media (max-width: @screen-sm-max) {
    padding-right: 0;
  }
  @media (min-width: @screen-sm-min) and (max-width: @screen-sm-max) {
    padding-right: @toc-width-sm;
  }
  @media (min-width: @screen-md-min) and (max-width: @screen-md-max) {
    padding-right: @toc-width-md;
  }
  @media (min-width: @screen-lg-min) {
    padding-right: @toc-width-lg;
  }

  /* Since we can't touch the html the TOC command generates, it looks mediocre
   until the page is ready and jquery can move it to its proper place. Until then,
   the not-ready class lets us hide it so the page doesn't jump suddenly.
  */
  &.not-ready #markdown-toc {
    display: none;
  }

  // Necessary hack so the anchors will align with the top of the content area
  // rather than the top of the page. Please read that page for limitations
  // of the method (this is method #2) before modifying header styles.
  // See http://nicolasgallagher.com/jump-links-and-viewport-positioning/
  // Additionally modified to set manual z index stacking order so code snippets
  // never fall behind a subsequent header and lose clickable area
  // pre {
  //   position: relative;
  //   z-index: 2;
  // }
  h1, h2, h3, h4 {
    position: relative;
    border-top: (@navbar-height + @site-content-padding-top) solid transparent;
    // subtract the height of the border, then re-add bootstrap's standard margin
    // so the style appears the same as before the hack
    margin-top: -1 * (@navbar-height + @site-content-padding-top) + @line-height-computed;
    background-clip: padding-box;
    z-index: -1;
  }
  h4 {
    margin-top: -1 * (@navbar-height + @site-content-padding-top) + @line-height-computed / 2;
  }


}
